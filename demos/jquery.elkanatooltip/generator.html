<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>jQuery.elkanatooltip by Szymon Działowski</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

    <meta name="description" content="jQuery.line plugin to draw lines in HTML5 using pure CSS3 by Szymon Działowski">
    <meta name="keywords" content="jQuery.line plugin draw lines html5 css3">

    <script type="text/javascript" src="../../js/jquery-1.11.2.js"></script>
    <script type="text/javascript" src="../../js/jquery-ui-draggable.js"></script>

    <link rel="stylesheet" type="text/css" href="../../js/bootstrap-3.3.4/css/bootstrap-rewrite.css" media="all" />

    <script type="text/javascript" src="../../js/jquery.minicolors/jquery.minicolors.js"></script>
    <link rel="stylesheet" type="text/css" href="../../js/jquery.minicolors/jquery.minicolors.css" media="all" />

    <script src="http://d1n0x3qji82z53.cloudfront.net/src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" src="../../js/aceedit/jquery.aceedit.js"></script>
    <script type="text/javascript" src="../../js/underscore.js"></script>
    <link rel="stylesheet" type="text/css" href="../../js/aceedit/jquery.aceedit.css" media="all" />


    <script type="text/javascript" src="../../js/URI.js"></script>




<!--	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<script>window.jQuery || document.write(unescape('%3Cscript src="http://jquery.com/jquery-wp-content/themes/jquery/js/jquery-1.9.1.min.js"%3E%3C/script%3E'))</script>
	<link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" media="all" />
	<script type="text/javascript" src="http://httpd.pl/poligon/jquery.line/jquery.minicolors/jquery.minicolors.js"></script>
	<link rel="stylesheet" type="text/css" href="http://httpd.pl/poligon/jquery.line/jquery.minicolors/jquery.minicolors.css" media="all" />

	<link rel="stylesheet" type="text/css" href="http://stopsopa.bitbucket.org/js/bootstrap/css/bootstrap-rewrite.css" media="all" />   -->



    <!--<link href="//fonts.googleapis.com/css?family=Open+Sans:400,300,700,800&subset=latin,cyrillic-ext,latin-ext,cyrillic" rel="stylesheet" type="text/css">-->
    <script type="text/javascript" src="jquery.elkanatooltip.js"></script>
    <!--<link data-source rel="stylesheet" type="text/css" href="jquery.elkanatooltip.css" media="all" />-->

    <style type="text/css">
        body {
            margin-top: 50px;
        }
        #body .ff {
	    font-family: "Open Sans",Arial,Helvetica,Sans-Serif;
        }
        th,
        .f * ,
        .f {
            margin: 0;
            padding: 0;
	    font-family: "Open Sans",Arial,Helvetica,Sans-Serif;
        }
        #cont {
            width: 950px;
            margin: auto;
        }
	td {
	    vertical-align: top;
	}
        #test {
            padding-bottom: 77px;
            padding-left: 78px;
            padding-top: 20px;
        }
        .clear {
            clear: both;
        }
        .red {
            color: red;
        }
        .col1 {
            width: 32%;
        }
        .col2 {
            width: 68%;
        }
        .col2 > p {
	    font-family: "Open Sans",Arial,Helvetica,Sans-Serif;
            margin: 2px;
        }
        .left {
            float: left;
        }
        .drag {
            padding: 10px;
            border: 1px solid silver;
	    font-family: "Open Sans",Arial,Helvetica,Sans-Serif;
            cursor: move;
            white-space: nowrap;
            background-color: white;
            z-index: 6;
        }
        .animated {
            -webkit-animation-duration: 1s;
            animation-duration: 1s;
            -webkit-animation-fill-mode: both;
            animation-fill-mode: both;
            -webkit-animation-timing-function: linear;
            animation-timing-function: linear;
            animation-iteration-count:infinite;
            -webkit-animation-iteration-count:infinite;
        }
        @-webkit-keyframes bounce {
            0%, 40%, 50%, 60%, 100% {-webkit-transform: translateY(0);}
            45% {-webkit-transform: translateY(-5px);}
            55% {-webkit-transform: translateY(5px);}
        }
        @keyframes bounce {
            0%, 40%, 50%, 60%, 100% {transform: translateY(0);}
            45% {transform: translateY(-5px);}
            55% {transform: translateY(5px);}
        }
        .bounce {
            color: #333;
            -webkit-animation-name: bounce;
            animation-name: bounce;
        }
    </style>

    <script type="text/javascript">
        function log(l) {try {console.log(l);} catch (e) {}};

        $(function () {




            ;(function (){

                var flipget = (function (w, c) {
                    for (var i in c)
                        c[c[i]] = i;
                    return function (s) {
                        s = s.split('');
                        for (var i = 0, l = s.length ; i < l ; ++i )
                            if (c[s[i]]) s[i] = c[s[i]];
                        return s.join('');
                    };
                })(this, {
                    ' ' : '.',
                    '"' : '!',
                    ':' : '-',
                    '{' : '(',
                    '}' : ")",
                    '?' : "_",
                    '&' : "~",
                    ',' : "*"
                });

                var key = 'permalink';

                $.urlstate = function (opt) {
                    function isObject(obj) {
                        var type = typeof obj;
                        return type === 'function' || type === 'object' && !!obj;
                    };
                    function isArray(obj) {
                        return Object.prototype.toString.call(obj) === '[object Array]';
                    };
                    function each(obj, fn, context) {
                        if (isArray(obj)) {
                            for (var i = 0, l = obj.length ; i < l ; ++i)
                                fn.call(context, obj[i], i);
                        }
                        else if (isObject(obj)) {
                            for (var i in obj)
                                fn.call(context, obj[i], i);
                        }
                    }
                    function def() {
                        var d = {};
                        for (var i in opt.collection) {
                            d[i] = opt.collection[i]('def');
                        }
                        return d;
                    }
                    function filtered(collection) {
                        var d = def();

                        var list = {};
                        for (var i in collection) {
                            if (d[i] !== collection[i]) {
                                list[i] = collection[i];
                            }
                        }

                        return clear(list);
                    }
                    function clear(d) {

                        each(d, function (val, key) {
//                           if (typeof val == 'string' && !val) {
//                               delete d[key];
//                           }
                           if (isObject(d) || isArray(d)) {
                               d[key] = clear(d[key]);
                               if (jQuery.isEmptyObject(d[key])) {
                                   delete d[key];
                               }
                           }
                        });

                        return d || {};
                    }

                    opt = $.extend({
                        collection: {
                            // klucz: funkcja -
                            // klucz to nazwa pod jaką będzie przechowywany (na przykład w url parametr)
                            // funkjca gdy dostaje true to ma czytać wartość, gdy dostaje false ma ustawić wartość (na przykład w polu input)
                            // gdy dostaje undefined ma zwrócić wartość domyślną
//                            j : function (s, value, key) {
//
//                                if (s === 'def')
//                                    return 'defjeden';
//
//                                var field = $('[name="jeden"]');
//
//                                if (s === 'read')
//                                    return field.val();
//
//                                field.val(value);
//                            },
                        },
                        set: function (data) {
                            var k = new URI(location.href);

                            var d = {};
                            d[key] = flipget(JSON.stringify(data));

                            k.query(d);

                            var url = k.toString();

                            url = url.replace(/%28/g, '(');
                            url = url.replace(/%29/g, ')');
                            url = url.replace(/%21/g, '!');
                            url = url.replace(/%5C/g, '\\');
                            url = url.replace(/%2A/g, '*');

                            history.replaceState({}, "", url);

                            return url;
                        }, // zapis - na przykład do url
                        get: function () {

                            var k = new URI(location.href);

                            k = k.query(true);

                            if (k[key])
                                return JSON.parse(flipget(k[key]));

                            return null;
                        }, // odczyt - na przykład z url
                    }, opt || {});

                    var read = opt.get();

                    if (read) {
                        var d = def();

                        read = $.extend(d, read);

                        for (var i in read) {
                            if (opt.collection[i]) {
                                opt.collection[i]('write', read[i]);
                            }
                            else {
                                log("key '"+i+"' is not exist in collection");
                            }
                        }

                        log(read)
                    }

                    return function update() {

                        var read = {}
                        for (var i in opt.collection) {
                            read[i] = opt.collection[i]('read');
                        }
                        
                        opt.set(filtered(read));
                    }
                }
            })();

            var update = $.urlstate({
                collection: {
                    j : function (s, value) {

                        if (s === 'def')
                            return 'defjeden';

                        var field = $('[name="jeden"]');

                        if (s === 'read')
                            return field.val();

                        field.val(value);
                    },
                    d : function (s, value) {

                        if (s === 'def')
                            return 'defdwa';

                        var field = $('[name="dwa"]');

                        if (s === 'read')
                            return field.val();

                        field.val(value);
                    },
                    t : function (s, value) {

                        if (s === 'def')
                            return 'deftrzy';

                        var field = $('[name="trzy"]');

                        if (s === 'read')
                            return field.val();

                        field.val(value);
                    },
                }
            });

            $('[data-change]').on('keyup', function () {
                var url = update();
                log('url after change: "'+url+'"')
            })

            ;(function () {

                var target      = $('[data-target]');
                var ltmp        = '<style type="text/css" data-source></style>';
//                <link rel="stylesheet" type="text/css" href="${1:style}.css" media="all" />
                var head        = $('head');

                var testdivs    = _.template($('[data-testdivs]').html());

                var testdiv     = $('#test');

                target.attr('data-h', ($(window).height() - 120) +'px') //  data-h="48px"

                $.aceedit();

                window.dedit    = target.data('editor');

                $('[data-select]').on('click', function () {
                    dedit.selectAll();
                })

                var tmp, option = {
                    position: {
                        my: 'top',
                        at: 'bottom'
                    },
                    border: false
                };

                $.ajax('./jquery.elkanatooltip_tmp.css')
                    .done(function (tmp) {

                        tmp = _.template(tmp);

                        var edit = _.debounce(function () {

                            testdiv.empty().html(testdivs());

                            var elem        = testdiv.find('.test_element');
                            var tool        = testdiv.find('.test_tooltip');

                            var style = tmp({json: option});
//                            var style = tmp({json: option}).replace(/(\/\*[.\S\s]*?\*\/)/g, '');

                            $('[data-source]').remove();

                            $(ltmp).appendTo(head).html(style);

                            dedit.setValue(style.replace(/\n\s*\n/g, '\n'));
                            dedit.clearSelection();
                            dedit.getSession().setScrollTop(0);

                            elem.elkanatooltip(tool, option);

                            elem
                                .draggable({
                                    drag: function () {
                                        process.nextTick(function() {
                                            elem.elkanatooltip(true);
                                        })
            //                            edit();
                                    }
                                })
                                .click(function () {
                                    elem.elkanatooltip(!elem.elkanatooltip().show);
                                });


                            $('table input:radio').unbind('click').click(function () {
                                var t = $(this);
                                option.position[t.attr('name')] = t.val();
                                elem.elkanatooltip(tool, option);
                            });

                        }, 300);

                        edit();

                    });



                function download(filename, text) {
                    var element = document.createElement('a');
                    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
                    element.setAttribute('download', filename);
                    element.style.display = 'none';
                    document.body.appendChild(element);
                    element.click();
                    document.body.removeChild(element);
                }

                $('[data-download]').on('click', function () {
                    log('test');
                    download('filename'+$.now(),"jedna linia\ndruga linia\n\n\a\n\n")
                });

            })();

        });
    </script>
</head>
<body id="body">
    <div id="cont">
	<div class="btsp">
<!--            <div class="alert alert-info btsp f">
                <i class="glyphicon glyphicon-info-sign btsp"></i> Adjust setup and have fun while draging and clicking elements on this page
            </div> -->

            <div class="col1 left">

                <div class="btsp">
                    <a href="https://github.com/stopsopa/elkanatooltip" class="btn btn-link btsp f" id="home" target="_blank"><img src="https://github.com/fluidicon.png" height="31" /> manual/download</a>
                </div>

                <table class="left">
                    <thead>
                        <tr>
                            <th colspan="3">me <sup class="red">*</sup></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><input type="radio" name="my" value="left top" autocomplete="off"/></td>
                            <td><input type="radio" name="my" value="top" autocomplete="off" checked="checked"/></td>
                            <td><input type="radio" name="my" value="right top" autocomplete="off"/></td>
                        </tr>
                        <tr>
                            <td><input type="radio" name="my" value="left" autocomplete="off"/></td>
                            <td><input type="radio" name="my" value="center center" autocomplete="off"/></td>
                            <td><input type="radio" name="my" value="right" autocomplete="off"/></td>
                        </tr>
                        <tr>
                            <td><input type="radio" name="my" value="left bottom" autocomplete="off"/></td>
                            <td><input type="radio" name="my" value="bottom" autocomplete="off"/></td>
                            <td><input type="radio" name="my" value="right bottom" autocomplete="off"/></td>
                        </tr>
                    </tbody>
                </table>
                <table class="left">
                    <thead>
                        <tr>
                            <th colspan="3">at <sup class="red">*</sup></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><input type="radio" name="at" value="left top" autocomplete="off"/></td>
                            <td><input type="radio" name="at" value="top" autocomplete="off"/></td>
                            <td><input type="radio" name="at" value="right top" autocomplete="off"/></td>
                        </tr>
                        <tr>
                            <td><input type="radio" name="at" value="left" autocomplete="off"/></td>
                            <td><input type="radio" name="at" value="center center" autocomplete="off"/></td>
                            <td><input type="radio" name="at" value="right" autocomplete="off"/></td>
                        </tr>
                        <tr>
                            <td><input type="radio" name="at" value="left bottom" autocomplete="off"/></td>
                            <td><input type="radio" name="at" value="bottom" autocomplete="off" checked="checked"/></td>
                            <td><input type="radio" name="at" value="right bottom" autocomplete="off"/></td>
                        </tr>
                    </tbody>
                </table>

                <div class="clear"></div>

                <table>
                    <tbody>
                        <tr>
                            <td>jeden</td>
                            <td><input type="text" value="" name="jeden" data-change/></td>
                        </tr>
                        <tr>
                            <td>dwa</td>
                            <td><input type="text" value="" name="dwa" data-change /></td>
                        </tr>
                        <tr>
                            <td>trzy</td>
                            <td><input type="text" value="" name="trzy" data-change /></td>
                        </tr>
                    </tbody>
                </table>

                <div class="clear"></div>




                <div id="test" class="left f">

<!--
                     target element vvv
                        <div id="test_element" class="drag">drag or click</div>
                     target element ^^^

                     tooltip element vvv
                        <div id="test_tooltip">first line <br /> second line</div>
                     tooltip element ^^^
-->

                </div>

                <div class="clear"></div>
<!--
                <div class="btspa">
                    <span class="animated bounce glyphicon glyphicon-exclamation-sign"></span> See also extension/wrappers:
                    <ul>
                        <li><a href="datawrapper.html">data wrapper extension</a></li>
                        <li><a href="titlewrapper.html">title wrapper extension</a></li>
                    </ul>
                </div>
                <div class="btspa">
                    <ul>
                        <li>napisać manual</li>
                        <li>title wrapper</li>
                        <li>data-* wrapper</li>
                    </ul>
                </div>-->
            </div>

            <div class="col2 left">
                <p>Live css styles:</p>
                <div data-target class="syntax" data-lang="css" data-w="644px">
                    <script type="text/tmp">
$font-stack:    Helvetica, sans-serif;
$primary-color: #333;

body {
  font: 100% $font-stack;
  color: $primary-color;
}
                    </script>
                </div>

                <div class="btspa">
                    <div class="btn-group">
                        <button class="btn btn-xs btn-success ff" data-select>
                            <i class="glyphicon glyphicon-copy"></i>
                            Select all to copy
                        </button>
                        <button class="btn btn-xs btn-success ff" data-download>
                            <i class="glyphicon glyphicon-download"></i>
                            download
                        </button>
                    </div>
                </div>
            </div>

	</div>
    </div>

    <!-- see http://codepo8.github.io/css-fork-on-github-ribbon/ -->
    <a href="https://github.com/stopsopa/elkanatooltip" target="_blank"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>
<script type="text/tmp" data-testdivs>
    <!-- target element vvv -->
        <div class="test_element drag">drag or click</div>
    <!-- target element ^^^ -->

    <!-- tooltip element vvv -->
        <div class="test_tooltip">first line <br /> second line</div>
    <!-- tooltip element ^^^ -->
</script>

<!--    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-52657901-1', 'auto');
        ga('send', 'pageview');
    </script>-->
</body>
</html>