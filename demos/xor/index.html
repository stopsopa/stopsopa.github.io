<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Xor</title>
  </head>
  <body>
    <script>
      var log = (function () {
        try {
          return console.log;
        } catch (e) {
          return function () {};
        }
      })();

      var cypher = (function () {
        function xor(data, key) {
          var ret = "",
            l = key.length;
          for (var i = 0; i < data.length; i++) {
            ret += String.fromCharCode(key.charCodeAt(i % l) ^ data.charCodeAt(i));
          }
          return ret;
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/btoa#Unicode_strings
        function utoa(str) {
          return window.btoa(unescape(encodeURIComponent(str)));
        }
        function atou(str) {
          return decodeURIComponent(escape(window.atob(str)));
        }

        return function (key) {
          this.encode = function (data) {
            return utoa(xor(data, key));
          };
          this.decode = function (data) {
            return xor(atou(data), key);
          };
          this.xor = xor;
        };
      })();

      var data =
        "Ã— Ã· Â± âˆž Ï€ âˆ… â‰¤ â‰¥ â‰  â‰ˆ âˆ§ âˆ¨ âˆ© âˆª âˆˆ âˆ€ âˆƒ âˆ„ âˆ‘ âˆ â† â†‘ â†’ â†“ â†µ â†” â†• â†– â†— â†˜ â†™ â†º â†» â‡’ â‡” â€œ â€ â€˜ â€™ Â« Â» â€¦ Â° Â© Â® â„¢ â€¢ Â½ Â¼ Â¾ â…“ â…” â€  â€¡ Âµ Â¢ Â£ â‚¬ â™  â™£ â™¥ â™¦ âœ“ âœ¨ Î± Î² Î³ Î´ Îµ Î¶ Î· Î¸ Î¹ Îº Î» Î¼ Î½ Î¾ Î¿ Ï€ Ï Ïƒ Ï„ Ï… Ï† Ï‡ Ïˆ Ï‰ ðŸ˜€ ðŸ˜‚ ðŸ¤£ ðŸ˜‰ ðŸ˜Ž ðŸ¤” ðŸ˜ ðŸ™„ ðŸ¤‘ ðŸ˜¨ ðŸ˜± ðŸ˜ˆ ðŸ‘½ ðŸ’© ðŸ–– âœ‹ ðŸ‘ ðŸ‘Ž âœŠ ðŸ’£ ðŸ’¥ ðŸ¿ ðŸ© ðŸŒŽ ðŸŒ ðŸ›‘ âœˆ ðŸ”¥ âœ¨ ðŸŽ‰ ðŸ† â˜Ž ðŸ’¾ ðŸŽ¥ ðŸ’¡ ðŸ’° âœ‰ ðŸ”§ ðŸ‡¨ðŸ‡¦ ðŸ‡¬ðŸ‡§ ðŸ‡ºðŸ‡¸";
      var key = "klucz";

      var tool = new cypher(key);

      log(tool.encode(data));

      log(tool.decode(tool.encode(data)));
    </script>
  </body>
</html>
