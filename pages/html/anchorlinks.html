<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=q, initial-scale=1.0" />
    <title>Document</title>
    <!-- <style>
      body.tampermonkey_add_blue_animation_to_id_elements:not(tampermonkey_disable_blue_animation) [id] {
        animation: tampermonkey_blue_animation_keyframes 1s ease-out infinite !important;
      }
      @-webkit-keyframes tampermonkey_blue_animation_keyframes {
        0% {
          box-shadow: 0 0 0 rgb(13, 0, 255);
        }
        50% {
          box-shadow: 0 4px 0 rgb(13, 0, 255);
        }
        100% {
          box-shadow: 0 0 0 rgb(13, 0, 255);
        }
      }
      .tampermonkey_red_highlight {
        opacity: 1;
        animation: fade 2s linear;
      }
      @keyframes fade {
        0%,
        100% {
          box-shadow: 0 0 20px transparent, 0 0 60px transparent, 0 0 100px transparent, 0 0 150px transparent,
            0 0 200px transparent, 0 0 300px transparent;
        }
        50% {
          box-shadow: 0 0 20px red, 0 0 60px red, 0 0 100px red, 0 0 150px red, 0 0 200px red, 0 0 300px red;
        }
      }


    </style> -->

    <style>
      .hidden {
        display: none;
      }
      .hidden p {
        color: red;
      }
    </style>
  </head>
  <body>
    <div>
      <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. <span id="raz">Aliquam massa libero</span>, bibendum et
        massa vel, sodales aliquet neque. Nam vitae molestie felis, quis efficitur est. Suspendisse malesuada dolor
        sapien, sit amet porta dolor scelerisque et. Cras egestas risus quis varius pretium. Vivamus aliquam tempor nibh
        nec tempor. Donec hendrerit diam imperdiet, lobortis odio a, suscipit justo. Mauris sed urna pellentesque,
        accumsan erat at, luctus diam.
      </p>
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <p id="parent">
        Mauris tincidunt scelerisque lacus commodo suscipit. Mauris tortor elit, semper ut lorem non, mattis commodo
        orci. Praesent et lacus et magna ullamcorper porttitor. Sed metus enim, consequat vitae ex posuere, rhoncus
        pharetra sapien. Proin vulputate lacus massa, pretium <span id="child">parent</span> eleifend nibh sodales eu.
        Nunc accumsan hendrerit turpis at tristique. Class aptent taciti sociosqu ad litora torquent per conubia nostra,
        per inceptos himenaeos. Mauris ac metus sit amet nisi mollis rutrum nec eu turpis. Vivamus suscipit sem sit amet
        libero fringilla, vitae gravida lorem hendrerit. Nullam lacus lectus, sagittis in posuere sed, cursus a ex.
        Fusce interdum justo at maximus lacinia. Proin malesuada semper hendrerit.
      </p>

      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <p>
        Vivamus porta lectus arcu, non eleifend nulla dignissim in.
        <span id="dwa">Phasellus condimentum metus</span> sit amet dictum ullamcorper. Maecenas quam ipsum, consectetur
        in molestie vitae, dignissim viverra enim. Maecenas aliquet sed est in molestie. Phasellus faucibus fermentum
        risus, in tristique elit faucibus quis. Donec neque nulla, egestas ac sem non, interdum egestas diam. Quisque
        neque orci, venenatis ultrices tortor ac, sollicitudin volutpat sem. Vivamus quis posuere purus, non tristique
        urna. Mauris cursus aliquam suscipit. Proin eget tristique libero. Cras feugiat convallis felis, a pharetra
        nulla congue a. Donec luctus magna at malesuada congue.
      </p>

      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <br />
      <p>
        Nulla venenatis at orci id sodales. Ut non accumsan diam, et malesuada nisl.
        <span id="trzy cztery">Cras id ligula non ligula</span> vulputate malesuada at at tortor. Praesent et vehicula
        lorem, eget eleifend dolor. Maecenas hendrerit mauris vel dolor scelerisque tempor. Nam id nisl ac mauris
        sagittis malesuada. Mauris ultricies ultricies ornare. Sed a posuere dolor. Class aptent taciti sociosqu ad
        litora torquent per conubia nostra, per inceptos himenaeos. Praesent luctus ultricies eleifend. Lorem ipsum
        dolor sit amet, consectetur adipiscing elit. Morbi convallis urna vitae molestie rhoncus. Suspendisse nec
        imperdiet ante, vitae dapibus justo. Fusce ut risus velit. Proin consectetur, arcu non laoreet tincidunt, neque
        odio cursus diam, sit amet auctor ipsum augue sed ligula. Donec pulvinar, odio dignissim facilisis convallis,
        nisl felis scelerisque augue, a varius mi dui eu velit.
      </p>

      <p>
        Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Nullam ac ultricies
        arcu. In mattis tempor neque sit amet mollis. Duis semper faucibus magna sit amet porta. Vivamus enim tortor,
        facilisis a euismod et, feugiat id purus. Proin et suscipit nunc. Proin nisi libero, tempor sit amet viverra
        quis, gravida nec neque. Etiam cursus ante et vestibulum facilisis. Praesent nisl nibh, aliquam eget pharetra
        non, tincidunt in felis.
      </p>

      <div class="hidden">
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <p>
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. <span id="raz2">Aliquam massa libero</span>, bibendum
          et massa vel, sodales aliquet neque. Nam vitae molestie felis, quis efficitur est. Suspendisse malesuada dolor
          sapien, sit amet porta dolor scelerisque et. Cras egestas risus quis varius pretium. Vivamus aliquam tempor
          nibh nec tempor. Donec hendrerit diam imperdiet, lobortis odio a, suscipit justo. Mauris sed urna
          pellentesque, accumsan erat at, luctus diam.
        </p>
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <p id="parent2">
          Mauris tincidunt scelerisque lacus commodo suscipit. Mauris tortor elit, semper ut lorem non, mattis commodo
          orci. Praesent et lacus et magna ullamcorper porttitor. Sed metus enim, consequat vitae ex posuere, rhoncus
          pharetra sapien. Proin vulputate lacus massa, pretium <span id="child2">parent</span> eleifend nibh sodales
          eu. Nunc accumsan hendrerit turpis at tristique. Class aptent taciti sociosqu ad litora torquent per conubia
          nostra, per inceptos himenaeos. Mauris ac metus sit amet nisi mollis rutrum nec eu turpis. Vivamus suscipit
          sem sit amet libero fringilla, vitae gravida lorem hendrerit. Nullam lacus lectus, sagittis in posuere sed,
          cursus a ex. Fusce interdum justo at maximus lacinia. Proin malesuada semper hendrerit.
        </p>
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <p>
          Vivamus porta lectus arcu, non eleifend nulla dignissim in.
          <span id="dwa2">Phasellus condimentum metus</span> sit amet dictum ullamcorper. Maecenas quam ipsum,
          consectetur in molestie vitae, dignissim viverra enim. Maecenas aliquet sed est in molestie. Phasellus
          faucibus fermentum risus, in tristique elit faucibus quis. Donec neque nulla, egestas ac sem non, interdum
          egestas diam. Quisque neque orci, venenatis ultrices tortor ac, sollicitudin volutpat sem. Vivamus quis
          posuere purus, non tristique urna. Mauris cursus aliquam suscipit. Proin eget tristique libero. Cras feugiat
          convallis felis, a pharetra nulla congue a. Donec luctus magna at malesuada congue.
        </p>
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <p>
          Nulla venenatis at orci id sodales. Ut non accumsan diam, et malesuada nisl.
          <span id="trzy cztery2">Cras id ligula non ligula</span> vulputate malesuada at at tortor. Praesent et
          vehicula lorem, eget eleifend dolor. Maecenas hendrerit mauris vel dolor scelerisque tempor. Nam id nisl ac
          mauris sagittis malesuada. Mauris ultricies ultricies ornare. Sed a posuere dolor. Class aptent taciti
          sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Praesent luctus ultricies eleifend.
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi convallis urna vitae molestie rhoncus.
          Suspendisse nec imperdiet ante, vitae dapibus justo. Fusce ut risus velit. Proin consectetur, arcu non laoreet
          tincidunt, neque odio cursus diam, sit amet auctor ipsum augue sed ligula. Donec pulvinar, odio dignissim
          facilisis convallis, nisl felis scelerisque augue, a varius mi dui eu velit.
        </p>

        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <br />
        <p>
          Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Nullam ac
          ultricies arcu. In mattis tempor neque sit amet mollis. Duis semper faucibus magna sit amet porta. Vivamus
          enim tortor, facilisis a euismod et, feugiat id purus. Proin et suscipit nunc. Proin nisi libero, tempor sit
          amet viverra quis, gravida nec neque. Etiam cursus ante et vestibulum facilisis. Praesent nisl nibh, aliquam
          eget pharetra non, tincidunt in felis.
        </p>
      </div>
    </div>

    <script>
      const log = console.log;
    </script>

    <!-- logic for tampermonkey -->
    <!-- logic for tampermonkey -->
    <!-- logic for tampermonkey -->
    <!-- logic for tampermonkey -->
    <!-- logic for tampermonkey -->
    <!-- logic for tampermonkey -->
    <!-- logic for tampermonkey vvv -->
    <script>
      /**
       * Block taking care of element red aura after focusing it on the center of the screen
       */
      (function () {
        const unmountAfter = 3000;
        let hash = (location.hash || "").split("#")[1];

        log(`hash >${hash}<`);

        if (hash) {
          hash = decodeURIComponent(hash);
          (function () {
            let scrollValue = false;
            function scroll() {
              if (!scrollValue) {
                scrollValue = document.documentElement.scrollTop;
              } else {
                if (scrollValue && document.documentElement.scrollTop !== scrollValue) {
                  scrollValue = false;
                  unmount();
                }
              }
            }
            function flipAnimationClass(element) {
              element.classList.remove("tampermonkey_disable_blue_animation");
              log(`document.body.classList.remove("tampermonkey_disable_blue_animation")`, document.body);

              const { unmountStyle, styleElement } = addCss(`
[id="${hash}"] {
  opacity: 1;
  animation: fade 2s linear;
}              
              `);
              log(`addCss(#${hash})`, styleElement);
              setTimeout(() => {
                element.classList.add("tampermonkey_disable_blue_animation");
                log(`document.body.classList.add("tampermonkey_disable_blue_animation")`, document.body);
                unmountStyle();
                log(`unmountCss(#${hash})`, styleElement);
              }, 2000);
            }
            function attemptToFindAndScroll() {
              const element = document.getElementById(hash);
              log("attemptToFindAndScroll", hash);
              if (element && element.offsetParent) {
                log(`element.scrollIntoView({ behavior: "smooth" })`, element);
                element.scrollIntoView({ behavior: "smooth" });
                setTimeout(() => {
                  flipAnimationClass(element);
                  log("finished scrolling");
                }, 1000);
                return element;
              }
            }
            let handler;
            (function repeat() {
              if (!attemptToFindAndScroll()) {
                handler = setTimeout(repeat, 500);
              }
            })();
            setTimeout(() => {
              if (handler) {
                clearTimeout(handler);
                handler = undefined;
                log(`coun't find hash>${hash}< element for ${unmountAfter} ms, unmounting logic`);
              }
              log("final forced scroll");
              attemptToFindAndScroll();
            }, unmountAfter);
            function unmount() {
              clearTimeout(handler);
              handler = undefined;
              window.removeEventListener("scroll", scroll);
              log("unmounting");
            }
            window.addEventListener("scroll", scroll);
          })();
        }
      })();

      /**
       * hiding animation of blinking elements with [id] in right moment of end of animation
       */
      (function () {
        let handler;
        let timer = false;
        const interval = 1000;
        document.addEventListener(
          "mousemove",
          () => {
            if (!document.body.classList.contains("tampermonkey_add_blue_animation_to_id_elements")) {
              document.body.classList.add("tampermonkey_add_blue_animation_to_id_elements");
              log(`document.body.classList.add("tampermonkey_add_blue_animation_to_id_elements")`, document.body);
            }
            if (!timer) {
              timer = new Date();
            }
            clearTimeout(handler);
            handler = setTimeout(() => {
              const n = new Date();
              // log("start", timer, timer.getTime());
              // log("end__", n, n.getTime());
              // log("diff_", n.getTime() - timer.getTime());
              // log("modu", (n.getTime() - timer.getTime()) % interval);
              const left = interval - ((n.getTime() - timer.getTime()) % interval);
              handler = setTimeout(() => {
                log("removeClass");
                document.body.classList.remove("tampermonkey_add_blue_animation_to_id_elements");
                log(`document.body.classList.remove("tampermonkey_add_blue_animation_to_id_elements")`, document.body);
              }, left);
              timer = false;
            }, interval);
          },
          false
        );
      })();
      /**
       * Handling right click on element
       * It supposed to trigger the logic only after clicking right for the second time
       */
      document.body.addEventListener("contextmenu", function (e) {
        try {
          var el = e.target;

          var match = el.matches("[id]");

          if (match) {
            log("match: ", el, el.getAttribute("id"), "e.target.dataset", e.target.dataset);
            if (e.target.dataset.tampermonkey_blue_animation_keyframes) {
              delete e.target.dataset.tampermonkey_blue_animation_keyframes;
              log("second");
              e.preventDefault();

              const div = box(
                `<input class="long" type="text" style="width: 100%"><br /><input class="short" type="text" style="width: 100%"><br /><input class="id" type="text" style="width: 100%">`,
                {
                  style: {
                    backgroundColor: "blue",
                    width: "50%",
                  },
                  //   autoclose: 1000,
                }
              );

              const long = div.querySelector(".long");
              const short = div.querySelector(".short");
              const id = div.querySelector(".id");

              short.addEventListener("click", () => {
                short.select();
              });
              long.addEventListener("click", () => {
                long.select();
              });
              id.addEventListener("click", () => {
                id.select();
              });

              const hash = encodeURIComponent(el.getAttribute("id"));

              short.value = location.pathname + location.search + "#" + hash;

              long.value = location.href.split("#")[0] + "#" + hash;

              id.value = hash;
            } else {
              e.target.dataset.tampermonkey_blue_animation_keyframes = true;
              log("first");
            }
          }
        } catch (e) {
          log("contextmenu error: ", e);
        }
      });

      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods
      // tooling methods

      1 &&
        addCss(`
      body.tampermonkey_add_blue_animation_to_id_elements [id]:not(.tampermonkey_red_highlight) {
        animation: tampermonkey_blue_animation_keyframes 1s ease-out infinite !important;
      }
      @-webkit-keyframes tampermonkey_blue_animation_keyframes {
        0% {
          box-shadow: 0 0 0 rgb(13, 0, 255);
        }
        50% {
          box-shadow: 0 4px 0 rgb(13, 0, 255);
        }
        100% {
          box-shadow: 0 0 0 rgb(13, 0, 255);
        }
      }
      .tampermonkey_red_highlight {
        opacity: 1;
        animation: fade 2s linear !important;
      }
      @keyframes fade {
        0%,
        100% {
          box-shadow: 0 0 20px transparent, 0 0 60px transparent, 0 0 100px transparent, 0 0 150px transparent,
            0 0 200px transparent, 0 0 300px transparent;
        }
        50% {
          box-shadow: 0 0 20px red, 0 0 60px red, 0 0 100px red, 0 0 150px red, 0 0 200px red, 0 0 300px red;
        }
      }
      `);

      /**
       * https://stackoverflow.com/a/524721
       */
      function addCss(css) {
        var head = document.head || document.getElementsByTagName("head")[0];

        var styleElement = document.createElement("style");

        head.appendChild(styleElement);

        styleElement.type = "text/css";

        styleElement.appendChild(document.createTextNode(css));

        return {
          unmountStyle: () => {
            styleElement.parentNode.removeChild(styleElement);
          },
          styleElement,
        };
        return;
      }
      /**
             * usage
             *
              const div = box(`<input type="text" style="width: 100%" value="test">`, {
                  style: {
                      backgroundColor: "blue",
                      width: "50%",
                  },
              });

              const input = div.querySelector("input");

              input.addEventListener("click", () => {
                  input.select();
              });
              */
      function box(content, opt) {
        if (!opt) {
          opt = {};
        }

        var div = document.createElement("div");

        const style = {
          position: "fixed",
          zIndex: "10000000",
          top: "20%",
          left: "50%",
          border: "1px solid gray",
          backgroundColor: "white",
          transform: "translate(-50%, -50%)",
          padding: "10px",
          cursor: "pointer",
        };

        Object.assign(
          div.style,
          Object.entries(Object.assign({}, style, opt.style)).reduce((acc, [key, val]) => {
            if (val !== false) acc[key] = val;
            return acc;
          }, {})
        );

        if (typeof content === "string") {
          div.innerHTML = String(content);
        } else {
          node.innerHTML = "";
          div.appendChild(content);
        }

        document.body.appendChild(div);

        let divClicked = false;
        div.addEventListener("click", () => {
          divClicked = true;
        });
        function bodyclick() {
          if (!divClicked) {
            close();
          }
          divClicked = false;
        }
        function close() {
          document.body.removeChild(div);

          document.body.removeEventListener("click", bodyclick);
        }

        document.body.addEventListener("click", bodyclick);

        if (opt.autoclose) {
          setTimeout(close, Number.isInteger(opt.autoclose) ? opt.autoclose : 1000);
        }

        typeof opt.fn === "function" && opt.fn(div);

        return div;
      }
    </script>
    <!-- logic for tampermonkey ^^^ -->
    <!-- logic for tampermonkey -->
    <!-- logic for tampermonkey -->
    <!-- logic for tampermonkey -->
    <!-- logic for tampermonkey -->

    <script>
      const hidden = document.querySelector(".hidden");
      setTimeout(() => {
        hidden.classList.remove("hidden");
        log(`hidden.classList.remove("hidden")`, hidden);
      }, 2000);
    </script>
  </body>
</html>
