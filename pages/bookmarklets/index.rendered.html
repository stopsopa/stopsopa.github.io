<!--

WARNING: 
File was created by /bin/bash template.sh template engine.
Edit template instead of this file
WARNING: 

WARNING: 
File was created by /bin/bash template.sh template engine.
Edit template instead of this file
WARNING: 

WARNING: 
File was created by /bin/bash template.sh template engine.
Edit template instead of this file
WARNING: 

WARNING: 
File was created by /bin/bash template.sh template engine.
Edit template instead of this file
WARNING: 

--><!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>stopsopa.github.io</title>
  </head>
  <body class="layout bg" toc>
    <div class="body">
      <div class="inside">
        <h2>🧰 toolbox</h2>
        <a href="https://github.com/stopsopa/stopsopa.github.io/blob/master/pages/bookmarklets/toolbox.js"
          >https://github.com/stopsopa/stopsopa.github.io/blob/master/pages/bookmarklets/toolbox.js</a
        >
        <br />
        <a href="/pages/bookmarklets/toolbox.html">/pages/bookmarklets/toolbox.html</a>
        <h2>Jira create ticket - script to widen "Project" dropdown</h2>
        <a href="javascript:var k = !(function () {%22use strict%22;(()=>{function v(e,r){return A(e)||p(e,r)||g(e,r)||h()}function h(){throw new TypeError(`Invalid attempt to destructure non-iterable instance. In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g(e,r){if(e){if(typeof e==%22string%22)return d(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t===%22Object%22&&e.constructor&&(t=e.constructor.name),t===%22Map%22||t===%22Set%22)return Array.from(e);if(t===%22Arguments%22||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return d(e,r)}}function d(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,l=new Array(r);t<r;t++)l[t]=e[t];return l}function p(e,r){var t=e==null?null:typeof Symbol<%22u%22&&e[Symbol.iterator]||e[%22@@iterator%22];if(t!=null){var l,f,u,n,o=[],i=!0,a=!1;try{if(u=(t=t.call(e)).next,r===0){if(Object(t)!==t)return;i=!1}else for(;!(i=(l=u.call(t)).done)&&(o.push(l.value),o.length!==r);i=!0);}catch(c){a=!0,f=c}finally{try{if(!i&&t.return!=null&&(n=t.return(),Object(n)!==n))return}finally{if(a)throw f}}return o}}function A(e){if(Array.isArray(e))return e}(function(){var e=function(){try{return console.log}catch{return function(){}}}(),r=function(n,o){o||(o=document);var i=o.querySelector(n);if(!i)throw new Error(%22cant find element by selector: %22+n);return i};function t(u,n){n||(n={});var o=document.createElement(%22div%22),i={position:%22fixed%22,zIndex:%2210000000%22,top:%2220%%22,left:%2250%%22,border:%221px solid gray%22,backgroundColor:%22white%22,transform:%22translate(-50%, -50%)%22,padding:%2210px%22,cursor:%22pointer%22};Object.assign(o.style,Object.entries(Object.assign({},i,n.style)).reduce(function(c,b){var s=v(b,2),m=s[0],y=s[1];return y!==!1&&(c[m]=y),c},{})),o.innerHTML=String(u),document.body.appendChild(o);var a=function(){document.body.removeChild(o)};n.autoclose?setTimeout(a,Number.isInteger(n.autoclose)?n.autoclose:1e3):o.addEventListener(%22click%22,a),typeof n.fn==%22function%22&&n.fn(o)}try{var l=r(%22#project-field%22);l.style.maxWidth=%22none%22;var f=l.parentNode;f.style.maxWidth=%22none%22,t(%22All good%22,{autoclose:200})}catch(u){t(u,{style:{minHeight:%22200%22}})}})();})();
}())"
          >Jira wide project dropdown - bookmarklet</a
        >
        <br />
        source:
        <script type="editor" data-lang="js">
          /**
           * Jira create ticket - script to widen "Project" dropdown
           * https://stopsopa.github.io/pages/bookmarklets/index.html#jira-create-ticket-script-to-widen-project-dropdown
           */
          (function () {
            var log = (function () {
              try {
                return console.log;
              } catch (e) {
                return function () {};
              }
            })();
          
            var find = function (selector, parent) {
              if (!parent) {
                parent = document;
              }
          
              var tmp = parent.querySelector(selector);
          
              if (!tmp) {
                throw new Error("cant find element by selector: " + selector);
              }
          
              return tmp;
            };
          
            function box(content, opt) {
              if (!opt) {
                opt = {};
              }
          
              var div = document.createElement("div");
          
              const style = {
                position: "fixed",
                zIndex: "10000000",
                top: "20%",
                left: "50%",
                border: "1px solid gray",
                backgroundColor: "white",
                transform: "translate(-50%, -50%)",
                padding: "10px",
                cursor: "pointer",
              };
          
              Object.assign(
                div.style,
                Object.entries(Object.assign({}, style, opt.style)).reduce((acc, [key, val]) => {
                  if (val !== false) acc[key] = val;
                  return acc;
                }, {})
              );
          
              div.innerHTML = String(content);
          
              document.body.appendChild(div);
          
              var close = function () {
                document.body.removeChild(div);
              };
          
              if (opt.autoclose) {
                setTimeout(close, Number.isInteger(opt.autoclose) ? opt.autoclose : 1000);
              } else {
                div.addEventListener("click", close);
              }
          
              typeof opt.fn === "function" && opt.fn(div);
            }
          
            try {
              var doc = find("#project-field");
          
              doc.style.maxWidth = "none";
          
              var parent = doc.parentNode;
          
              parent.style.maxWidth = "none";
          
              box("All good", { autoclose: 200 });
            } catch (e) {
              box(e, { style: { minHeight: "200" } });
            }
          })();
          
        </script>
        <h2>periscope</h2>

        <a href="javascript:var k = !(function () {%22use strict%22;(()=>{(function(){function w(r){var n=document.head||document.getElementsByTagName(%22head%22)[0],e=document.createElement(%22style%22);return n.appendChild(e),e.type=%22text/css%22,e.appendChild(document.createTextNode(r)),{unmountStyle:function(){e.parentNode.removeChild(e)},styleElement:e}}w(` #periscope_div { position: fixed; width: 200px; height: 200px; overflow: hidden; border: 1px solid gray; top: 0; left: 0; background-color: white; z-index:1000000; } #periscope_div video { border: 1px solid red; opacity: 0.5; height: 100vh; width: 100vw; } #periscope_div canvas { border: 1px solid green; } `);function v(r){var n=localStorage.getItem(r);if(n!==null){var e=parseInt(n,10);return isNaN(e)?n:e}}function y(r,n){n!==null&&typeof n<%22u%22&&localStorage.setItem(r,String(n))}function x(r){return window.getComputedStyle(r)}function g(r,n,e){var a=0,l=0,s=!1,d,i;function p(u){if(s=!0,a=u.pageX,l=u.pageY,typeof e==%22function%22){var o=e();d=o.x,i=o.y}else d=i=0;n(d+u.pageX-a,i+u.pageY-l,%22mousedown%22);function t(c){s&&n(d+c.pageX-a,i+c.pageY-l,%22mousemove%22)}document.addEventListener(%22mouseup%22,function(c){document.removeEventListener(%22mousemove%22,t),s&&(s=!1,n(d+c.pageX-a,i+c.pageY-l,%22mouseup%22))}),document.addEventListener(%22mousemove%22,t)}r.addEventListener(%22mousedown%22,p)}var b=console.log;navigator.mediaDevices.getDisplayMedia({audio:!1,video:!0,preferCurrentTab:!0}).then(function(r){var n={};document.addEventListener(%22keydown%22,function(o){n[o.key]=!0}),document.addEventListener(%22keyup%22,function(o){n[o.key]=!1});var e=document.createElement(%22div%22);e.setAttribute(%22id%22,%22periscope_div%22);var a=v(%22pw%22);a&&(e.style.width=%22%22.concat(a,%22px%22));var l=v(%22ph%22);l&&(e.style.height=%22%22.concat(l,%22px%22));var s=v(%22pl%22);s&&(e.style.left=%22%22.concat(s,%22px%22));var d=v(%22pt%22);d&&(e.style.top=%22%22.concat(d,%22px%22)),g(e,function(o,t){if(n.Shift)e.style.width=%22%22.concat(o,%22px%22),e.style.height=%22%22.concat(t,%22px%22),y(%22pw%22,o),y(%22ph%22,t);else if(!n.Meta){e.style.left=%22%22.concat(o,%22px%22),e.style.top=%22%22.concat(t,%22px%22),y(%22pl%22,o),y(%22pt%22,t);return}},function(){if(n.Shift){var o=x(e),t={x:parseInt(o.width,10)||0,y:parseInt(o.height,10)||0};return t}return{x:parseInt(e.style.left,10)||0,y:parseInt(e.style.top,10)||0}}),document.body.appendChild(e);var i=document.createElement(%22video%22);window.video=i,i.setAttribute(%22autoplay%22,!0),e.appendChild(i);var p=!1,u=function(){p=!1};i.addEventListener(%22ended%22,u),i.addEventListener(%22pause%22,u),i.addEventListener(%22play%22,function(o){b(%22play%22);var t=document.createElement(%22canvas%22);g(t,function(f,m){if(n.Meta){var h=%22translate(%22.concat(f,%22px, %22).concat(m,%22px)%22);y(%22ct%22,h),t.style.transform=h}},function(){var f=(t.style.transform||%22%22).match(/(-?\d+).*?(-?\d+)/)||[],m=parseInt(f[1],10)||0,h=parseInt(f[2],10)||0;return{x:m,y:h}}),e.insertBefore(t,e.firstChild),t.width=window.innerWidth,t.height=window.innerHeight,t.style.width=%22%22.concat(window.innerWidth,%22px%22),t.style.height=%22%22.concat(window.innerHeight,%22px%22);var c=v(%22ct%22);c&&(t.style.transform=c),p=!0,function f(){p&&window.requestAnimationFrame(function(){t.width=window.innerWidth,t.height=window.innerHeight,t.style.width=%22%22.concat(window.innerWidth,%22px%22),t.style.height=%22%22.concat(window.innerHeight,%22px%22),console.log(%22w%22,window.innerWidth,%22h%22,window.innerHeight),t.getContext(%222d%22).drawImage(i,0,0,window.innerWidth,window.innerHeight),f()})}()}),i.srcObject=r})})();})();
}())">🐟</a>
        <script type="editor" data-lang="js">
          (function () {
            function addCss(css) {
              var head = document.head || document.getElementsByTagName("head")[0];
              var styleElement = document.createElement("style");
              head.appendChild(styleElement);
              styleElement.type = "text/css";
              styleElement.appendChild(document.createTextNode(css));
              return {
                unmountStyle: () => {
                  styleElement.parentNode.removeChild(styleElement);
                },
                styleElement,
              };
              return;
            }
            addCss(`
            #periscope_div {
              position: fixed;
              width: 200px;
              height: 200px;
              overflow: hidden;
              border: 1px solid gray;
              top: 0;
              left: 0;
              background-color: white;
              z-index:1000000;
            }
            #periscope_div video {
              border: 1px solid red;
              opacity: 0.5;
              height: 100vh;
              width: 100vw;
            }
            #periscope_div canvas {
              border: 1px solid green;
            }
            `);
            function get(key) {
              const v = localStorage.getItem(key);
              if (v !== null) {
                const tmp = parseInt(v, 10);
                if (isNaN(tmp)) {
                  return v;
                }
                return tmp;
              }
            }
            function set(key, val) {
              if (val !== null && typeof val !== "undefined") {
                localStorage.setItem(key, String(val));
              }
            }
            function getStyle(el) {
              return window.getComputedStyle(el);
            }
            function drag(element, listener, fetch) {
              let pageX = 0;
              let pageY = 0;
              let down = false;
              let fetchX;
              let fetchY;
              function mousedown(e) {
                down = true;
                pageX = e.pageX;
                pageY = e.pageY;
                if (typeof fetch === "function") {
                  ({ x: fetchX, y: fetchY } = fetch());
                } else {
                  fetchX = fetchY = 0;
                }
                listener(fetchX + e.pageX - pageX, fetchY + e.pageY - pageY, "mousedown");
                function mousemove(e) {
                  if (down) {
                    listener(fetchX + e.pageX - pageX, fetchY + e.pageY - pageY, "mousemove");
                  }
                }
                document.addEventListener("mouseup", (e) => {
                  document.removeEventListener("mousemove", mousemove);
                  if (down) {
                    down = false;
                    listener(fetchX + e.pageX - pageX, fetchY + e.pageY - pageY, "mouseup");
                  }
                });
                document.addEventListener("mousemove", mousemove);
              }
              element.addEventListener("mousedown", mousedown);
            }
            // const button = document.querySelector("button");
            // const destroy = document.querySelector("#destroy");
            const log = console.log;
            // button.addEventListener("click", function () {
            // log("button");
            navigator.mediaDevices
              .getDisplayMedia({
                audio: false,
                video: true,
                preferCurrentTab: true, // https://stackoverflow.com/a/70665376
              })
              .then((stream) => {
                const keys = {};
                document.addEventListener("keydown", (e) => {
                  keys[e.key] = true;
                  // log("keydown keys", keys);
                });
                document.addEventListener("keyup", (e) => {
                  keys[e.key] = false;
                  // log("keyup keys", keys);
                });
                const parent = document.createElement("div");
                parent.setAttribute("id", "periscope_div");
                const pw = get("pw");
                if (pw) {
                  // log("lc", "pw", pw);
                  parent.style.width = `${pw}px`;
                }
                const ph = get("ph");
                if (ph) {
                  // log("lc", "ph", ph);
                  parent.style.height = `${ph}px`;
                }
                const pl = get("pl");
                if (pl) {
                  // log("lc", "pl", pl);
                  parent.style.left = `${pl}px`;
                }
                const pt = get("pt");
                if (pt) {
                  // log("lc", "pt", pt);
                  parent.style.top = `${pt}px`;
                }
                drag(
                  parent,
                  (x, y) => {
                    if (keys.Shift) {
                      parent.style.width = `${x}px`;
                      parent.style.height = `${y}px`;
                      set("pw", x);
                      set("ph", y);
                    } else {
                      if (!keys.Meta) {
                        parent.style.left = `${x}px`;
                        parent.style.top = `${y}px`;
                        set("pl", x);
                        set("pt", y);
                        return;
                      }
                    }
                  },
                  () => {
                    if (keys.Shift) {
                      const c = getStyle(parent);
                      const t = { x: parseInt(c.width, 10) || 0, y: parseInt(c.height, 10) || 0 };
                      // log("shift", t);
                      return t;
                    }
                    return { x: parseInt(parent.style.left, 10) || 0, y: parseInt(parent.style.top, 10) || 0 };
                  }
                );
                document.body.appendChild(parent);
                const video = document.createElement("video");
                window.video = video;
                // video.setAttribute("controls", true);
                // video.setAttribute("playsinline", true);
                video.setAttribute("autoplay", true);
                // video.style.display = "none";
                // function del() {
                //   video.parentNode.removeChild(video);
                //   SimpleObserver.removeEventListener("delete", del);
                // }
                // SimpleObserver.addEventListener("delete", del);
                //<video src="" controls playsinline autoplay></video>
                parent.appendChild(video);
                let play = false;
                const stop = () => {
                  // log("stop");
                  play = false;
                };
                video.addEventListener("ended", stop);
                video.addEventListener("pause", stop);
                video.addEventListener("play", (event) => {
                  log("play");
                  const canvas = document.createElement("canvas");
                  drag(
                    canvas,
                    (x, y) => {
                      if (keys.Meta) {
                        const trans = `translate(${x}px, ${y}px)`;
                        set("ct", trans);
                        canvas.style.transform = trans;
                      }
                    },
                    () => {
                      const transform = (canvas.style.transform || "").match(/(-?\d+).*?(-?\d+)/) || [];
                      const x = parseInt(transform[1], 10) || 0;
                      const y = parseInt(transform[2], 10) || 0;
                      // log("tran", canvas.style.transform, transform, x, y);
                      return { x, y };
                    }
                  );
                  // parent.appendChild(canvas);
                  parent.insertBefore(canvas, parent.firstChild);
                  // canvas.width = video.videoWidth;
                  // canvas.height = video.videoHeight;
                  // canvas.style.width = `${video.videoWidth}px`;
                  // canvas.style.height = `${video.videoHeight}px`;
                  canvas.width = window.innerWidth;
                  canvas.height = window.innerHeight;
                  canvas.style.width = `${window.innerWidth}px`;
                  canvas.style.height = `${window.innerHeight}px`;
                  const ct = get("ct");
                  // log("lc", "ct", ct);
                  if (ct) {
                    canvas.style.transform = ct;
                  }
                  play = true;
                  (function copy() {
                    if (!play) {
                      return;
                    }
                    // log("play");
                    window.requestAnimationFrame(() => {
                      canvas.width = window.innerWidth;
                      canvas.height = window.innerHeight;
                      canvas.style.width = `${window.innerWidth}px`;
                      canvas.style.height = `${window.innerHeight}px`;
                      console.log("w", window.innerWidth, "h", window.innerHeight);
                      // canvas.getContext("2d").drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
                      canvas.getContext("2d").drawImage(video, 0, 0, window.innerWidth, window.innerHeight);
                      copy();
                    });
                  })();
                });
                video.srcObject = stream;
              });
          
            // test scale block
            0 &&
              (function () {
                function box(content, opt) {
                  if (!opt) {
                    opt = {};
                  }
          
                  var div = document.createElement("div");
          
                  const style = {
                    position: "fixed",
                    zIndex: "10000000",
                    top: "20%",
                    left: "50%",
                    border: "1px solid gray",
                    backgroundColor: "white",
                    // transform: "translate(-50%, -50%)",
                    // padding: "10px",
                    // cursor: "pointer",
                  };
          
                  Object.assign(
                    div.style,
                    Object.entries(Object.assign({}, style, opt.style)).reduce((acc, [key, val]) => {
                      if (val !== false) acc[key] = val;
                      return acc;
                    }, {})
                  );
          
                  if (typeof content === "string") {
                    div.innerHTML = String(content);
                  } else {
                    node.innerHTML = "";
                    div.appendChild(content);
                  }
          
                  document.body.appendChild(div);
          
                  let divClicked = false;
                  div.addEventListener("click", () => {
                    log("div click");
                    divClicked = true;
                  });
                  function bodyclick() {
                    log("body click");
                    if (!divClicked) {
                      close();
                    }
                    divClicked = false;
                  }
                  function close() {
                    log("autoclose");
                    document.body.removeChild(div);
          
                    document.body.removeEventListener("click", bodyclick);
                  }
          
                  // document.body.addEventListener("click", bodyclick);
          
                  if (opt.autoclose) {
                    setTimeout(close, Number.isInteger(opt.autoclose) ? opt.autoclose : 1000);
                  }
          
                  typeof opt.fn === "function" && opt.fn(div);
          
                  return div;
                }
          
                box(`<div></div>`, {
                  autoclose: false,
                  style: {
                    position: "fixed",
                    top: "10px",
                    left: "10px",
                    height: "20px",
                    backgroundColor: "blue",
                    width: "20px",
                  },
                });
                box(`<div></div>`, {
                  autoclose: false,
                  style: {
                    position: "fixed",
                    top: "10px",
                    left: "800px",
                    height: "20px",
                    backgroundColor: "blue",
                    width: "20px",
                  },
                });
                box(`<div></div>`, {
                  autoclose: false,
                  style: {
                    position: "fixed",
                    top: "400px",
                    left: "10px",
                    height: "20px",
                    backgroundColor: "blue",
                    width: "20px",
                  },
                });
                // box(`<div></div>`, {
                //   autoclose: false,
                //   style: {
                //     position: "fixed",
                //     top: "0",
                //     left: "0",
                //     transform: "translate(1%, 1%)",
                //     backgroundColor: "yellow",
                //     height: "20px",
                //     height: `${window.innerHeight}px`,
                //     width: `${window.innerWidth}px`,
                //   },
                // });
              })();
            // });
            // destroy.addEventListener("click", function () {
            //   log("destroy");
            //   SimpleObserver.dispatchEvent("delete");
            // });
          })();
          
          // w 2560 h 732
          // w 2142 h 664
          
          // w 2560 h 688
          // w 1880 h 557
          
        </script>

        <hr />
        <a href="https://bookmarkify.it/51502">https://bookmarkify.it/51502</a>
      </div>
    </div>
    <script src="/js/github.js"></script>
  </body>
</html>
