"use strict";var B="\n  #periscope_div {\n    position: fixed;\n    width: 200px;\n    height: 200px;\n    overflow: hidden;\n    border: 1px solid gray;\n    top: 0;\n    left: 0;\n    background-color: white;\n    z-index:1000000;\n  }\n  #periscope_div video {\n    border: 1px solid red;\n    opacity: 0.5;\n    height: 100vh;\n    width: 100vw;\n  }\n  #periscope_div canvas {\n    border: 1px solid green;\n  }\n  ",C=document.head||document.getElementsByTagName("head")[0],D=document.createElement("style");C.appendChild(D);D.type="text/css";D.appendChild(document.createTextNode(B));function w(n){var o,n=localStorage.getItem(n);if(null!==n)return o=parseInt(n,10),isNaN(o)?n:o}function x(n,o){null!=o&&localStorage.setItem(n,String(o))}function z(n,e,i){var t,d,p=0,r=0,u=!1;n.addEventListener("mousedown",function(n){u=!0;p=n.pageX;r=n.pageY;if("function"==typeof i){var o=i();t=o.x;d=o.y}else t=d=0;e(t+n.pageX-p,d+n.pageY-r,"mousedown")});function o(n){if(u){u=!1;e(t+n.pageX-p,d+n.pageY-r,"mouseup")}}n.addEventListener("mouseup",o);n.addEventListener("mouseout",o);n.addEventListener("mousemove",function(n){u&&e(t+n.pageX-p,d+n.pageY-r,"mousemove")})}var A=console.log;navigator.mediaDevices.getDisplayMedia({o:!1,i:!0,t:!0}).then(function(n){var i={};document.addEventListener("keydown",function(n){i[n.key]=!0});document.addEventListener("keyup",function(n){i[n.key]=!1});var t=document.createElement("div"),o=(t.setAttribute("id","periscope_div"),w("pw")),o=(o&&(t.style.width="".concat(o,"px")),w("ph")),o=(o&&(t.style.height="".concat(o,"px")),w("pl")),o=(o&&(t.style.left="".concat(o,"px")),w("pt"));o&&(t.style.top="".concat(o,"px"));z(t,function(n,o){if(i.Shift){t.style.width="".concat(n,"px");t.style.height="".concat(o,"px");x("pw",n);x("ph",o)}else if(!i.Meta){t.style.left="".concat(n,"px");t.style.top="".concat(o,"px");x("pl",n);x("pt",o)}},function(){var n;return i.Shift?(n=window.getComputedStyle(t),{x:parseInt(n.width,10)||0,y:parseInt(n.height,10)||0}):{x:parseInt(t.style.left,10)||0,y:parseInt(t.style.top,10)||0}});document.body.appendChild(t);var d=document.createElement("video");(window.i=d).setAttribute("autoplay",!0);t.appendChild(d);function e(){p=!1}var p=!1;d.addEventListener("ended",e);d.addEventListener("pause",e);d.addEventListener("play",function(n){A("play");var e=document.createElement("canvas");z(e,function(n,o){if(i.Meta){n="translate(".concat(n,"px, ").concat(o,"px)");x("ct",n);e.style.transform=n}},function(){var n=(e.style.transform||"").match(/(-?\d+).*?(-?\d+)/)||[];return{x:parseInt(n[1],10)||0,y:parseInt(n[2],10)||0}});t.insertBefore(e,t.firstChild);e.width=window.innerWidth;e.height=window.innerHeight;e.style.width="".concat(window.innerWidth,"px");e.style.height="".concat(window.innerHeight,"px");var o=w("ct");o&&(e.style.transform=o);p=!0;!function n(){p&&window.requestAnimationFrame(function(){e.width=window.innerWidth;e.height=window.innerHeight;e.style.width="".concat(window.innerWidth,"px");e.style.height="".concat(window.innerHeight,"px");console.log("w",window.innerWidth,"h",window.innerHeight);e.getContext("2d").drawImage(d,0,0,window.innerWidth,window.innerHeight);n()})}()});d.srcObject=n});