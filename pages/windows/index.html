<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Windows - System Tools & Configuration</title>
  </head>
  <body class="layout bg" toc>
    <div class="body">
      <div class="inside">
        <h2>Useful</h2>
        <script type="editor" data-lang="python">

          mmsys.cpl
          shell:startup           - opens folder with shortuct to program to run on windows start
        </script>
        <h2>Do on fresh Windows 10</h2>
        <a href="disable_activate_watermark.reg" download="disable_activate_watermark.reg"
          >Disable Activate Watermark</a
        >
        <script type="editor" data-lang="python">

          #
        </script>
        <h2>Winutil</h2>
        <a href="/viewer.html?file=%2Fpages%2Fwindows%2Fwinutil.json"
          >/viewer.html?file=%2Fpages%2Fwindows%2Fwinutil.json</a
        >
        <br />
        <a href="GITHUB_SOURCES_PREFIX/blob/master/pages/windows/winutil.json">view on GitHub</a>
        <br />
        <a href="GITHUB_SOURCES_PREFIX/upload/master/pages/windows">update/replace on GitHub</a>
        <br />
        <a href="/pages/windows/winutil.json" download>download</a>

        <script type="editor" data-lang="python">

          irm christitus.com/win | iex

            from: https://christitustech.github.io/winutil/

          update:
            https://github.com/stopsopa/stopsopa.github.io/upload/master/pages/windows
        </script>

        <h2>WSL - static ip</h2>
        <a href="https://github.com/microsoft/WSL/issues/4210#issuecomment-648570493">static ip</a>

        <h2>ssH Server on windows</h2>
        <a href="https://websiteforstudents.com/how-to-install-openssh-server-on-windows-11/"
          >https://websiteforstudents.com/how-to-install-openssh-server-on-windows-11/</a
        >

        <h2>Disable Recall shit</h2>

        <script type="editor" data-lang="python">

          1 line checks status, second disables, third enables

          Dism /Online /Get-Featureinfo /Featurename:Recall
          Dism /Online /Disable-Feature /Featurename:Recall
          Dism /Online /Enable-Feature /Featurename:Recall
        </script>
        <h2>Programms</h2>
        <ul>
          <li>Turn on Clipboard History</li>
          <li><a href="https://lockhunter.com/startdownload.htm">https://lockhunter.com/startdownload.htm</a></li>
          <li>Install Chrome and disable chrome auto sign in</li>
          <li>Setup Explorer Quick Access settings in Folders options</li>
          <li>IrfanView</li>
          <li>Notepad++</li>
          <li>Disable adaptive brightness</li>
          <li>TreeSizeFree</li>
          <li>LockHunter</li>
          <li>ContextConsole Shell Extension-2.1.0</li>
          <li>Telegram</li>
          <li>Win+r -> shell:startup</li>
          <li>Bring back bin on the screen</li>
          <li>Opera</li>
          <li><a href="https://github.com/vhanla/winxcorners">WinXcorners</a></li>
          <li>powercfg -h off - turn off hibernation</li>
          <li>g(disable system recovery windows 11)</li>
          <li>g(windows 11 turn off autoplay)</li>
          <li>
            g(WinCDEmu) for mounting ico as virtual CD drives - Doesn't work on Windows 11 - mount from win itself or
            use "virtual clone drive"
          </li>
        </ul>
        <h2>Services to disable</h2>
        <p>start -> search for "Services" -> open app</p>
        <ul>
          <li>
            Windows Search
            <a href="https://www.elevenforum.com/t/enable-or-disable-search-indexing-in-windows-11.2943/#option2"
              >g(Enable or Disable Search Indexing in Windows 11)</a
            >
          </li>
          <li>Windows Push Notifications Users Service_xxxxxx</li>
        </ul>
        <h2>Enable or Disable Search Indexing in Windows 11</h2>
        from
        <a href="https://www.saintlad.com/disable-antimalware-service-windows-11/#use-the-registry-editor"
          >g(Enable or Disable Search Indexing in Windows 11)</a
        >

        <h2>Free [win|ctrl]+shift+s shortuct ()</h2>
        <a
          href="https://www.tenforums.com/software-apps/128305-how-disable-hotkey-snipping-tool-win-shift-s.html#post1588708"
          >https://www.tenforums.com/software-apps/128305-how-disable-hotkey-snipping-tool-win-shift-s.html#post1588708</a
        >
        <br />
        Create and run reg file:
        <script type="editor" data-lang="python">

          Windows Registry Editor Version 5.00

          [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
          "DisabledHotkeys"="S"
        </script>
        <h2>git bash pull.sh</h2>
        <a href="GITHUB_SOURCES_PREFIX/blob/master/pages/windows/pull.sh">rsync.sh</a>
        <script type="editor" data-lang="python">

          in registry enter:
          Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender
          create key of type "DWORD (32-bit) Value"
          give it value HEXADECIMAL "1"
          save
          restart windows
        </script>
        <h2>Installing Windows 11 without MS account</h2>
        <a href="https://youtu.be/s1wqOHo9Lb0?t=435"
          >we will see when they patch that - that will be definitely Windows over for me ( psst: already is over ... ;)
          )</a
        >
        <h2>git bash pull.sh</h2>
        <a href="GITHUB_SOURCES_PREFIX/blob/master/pages/windows/pull.sh">rsync.sh</a>
        <h2>Rebooting in the middle of the night</h2>
        <img src="https://i.imgur.com/Z4S8wrl.png" style="width: 480px" />
        <h2>IrfanView</h2>
        <script type="editor" data-lang="python">

          # crop
          select area in the image and then ctrl+y to crop
        </script>
        <h2>LAN - Share files</h2>
        <script type="editor" data-lang="python">

          This video is pretty compact guide: https://youtu.be/Ameo1hwrsv8
          Warning: it is required to create directory we want to share in main drive C: or D:
                   Creating directory to share in user directory won't work - write access errors on both machines (client and server)
        </script>
        <h2>Network restart</h2>
        <script type="editor" data-lang="python">

          ipconfig /flushdns
          netsh winsock reset
          # if that didn't help then press start and search "network reset"
          # that might require reinstalling vpn
        </script>

        <h2>Remap keyboard</h2>
        <a href="https://www.randyrants.com/2019/01/sharpkeys-3-9/"
          >https://www.randyrants.com/2019/01/sharpkeys-3-9/</a
        >
        <h2>Partition backup</h2>
        <a href="https://www.windowscentral.com/how-create-windows-10-usb-bootable-media-uefi-support">link</a>

        <h2>Launching Windows Special Folders</h2>
        <a href="https://docs.rainmeter.net/tips/launching-windows-special-folders/"
          >https://docs.rainmeter.net/tips/launching-windows-special-folders/</a
        >

        <script type="editor" data-lang="python">

          shell:Common Startup
          shell:Start Menu
        </script>
        <h2>Caffeine - lock screen</h2>
        <a href="https://www.zhornsoftware.co.uk/caffeine/"
          >g(Zhorn Software Caffeine Prevent your computer from going to sleep)</a
        >
        <br />
        <a href="https://www.virustotal.com/gui/file/c0593b4b65bb264a982d61a7b84f38b10a41972b49a217ef3a80a906a0c4ee08"
          >https://www.virustotal.com/gui/file/c0593b4b65bb264a982d61a7b84f38b10a41972b49a217ef3a80a906a0c4ee08</a
        >
        <h2>LAN - DirectPlay for old games</h2>
        <a href="preferipv4.reg" download="preferipv4.reg">preferipv4.reg</a>
        <script type="editor" data-lang="python">

          Found what was wrong mainly in this thread: https://www.codeweavers.com/compatibility/crossover/forum/settlers-3?msg=55527#c2
            "
                Check the IP your hostname resolves to. If your hostname is "mycomputer", then DirectPlay looks up the ip of "mycomputer"
              and binds itself to the network card that this IP is associated with. If, as by Unix defaults, this ip is 127.0.0.1,
              it will try to search for hosts on the loopback interface, and there won't be any to find.

                On Windows, the hostname's IP is always the IP of the last network interface that was brought up. That means that
              even on Windows you run into troubles if you have a WLAN, then start a wired interface. In that situation, you won't
              be able to play dplay games via WLAN on Windows.

              So if your external ip is 192.168.123.66(just an example), edit your /etc/hosts/ so that "mycomputer" resolves to 192.168.123.66.
            "

          So then solution really is to switch windows to first use ipv4 not ipv6 to resolve:
            $ hostname
              in my case it is vaio

          Example:
            $ ping vaio
            Pinging Vaio [::1] with 32 bytes of data:
            Reply from ::1: time<1ms
              That is not what we want -> host resolves to ipv6 loopback

          So prioritize ipv4:
            see file ABOVE preferipv4.reg
            That's what I've seen somewhere online:
              $ reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters" /v DisabledComponents /t REG_DWORD /d 32 /f
            And thats the variant generated by ChatGPT based on content from preferipv4.reg
              $ reg add               "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters" /v DisabledComponents /t REG_DWORD /d 0x4120 /f

            restart windows

          Another thing is that I had to connect laptops using Crossover RJ45 cable.
          I couldn't connect Settlers III via WI-FI even with changes presented above:

          Then reconfiguration of .../etc/hosts is needed (on both machines) to fix ping [hostname] to point it to main ip representing current machine
            create shortcut on desktop with:
              powershell -Command "Start-Process notepad.exe 'C:\Windows\System32\drivers\etc\hosts' -Verb runAs"
              then content for vaio:
                192.168.0.111 vaio
              and content for dell inspiron:
                192.168.0.101 [it's hostname]

            Run:
              $ ipconfig /flushdns

          And then test:
            $ ping vaio
              Pinging vaio [192.168.0.111] with 32 bytes of data:
              Reply from 192.168.0.111: bytes=32 time<1ms TTL=128
              Reply from 192.168.0.111: bytes=32 time<1ms TTL=128
            when you see ipv4 then it means success

          Setup fixed ip addresses for lan crossover for both machines and disable ipv6 for LAN:
            https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/configure-ipv6-in-windows#:~:text=This%20registry%20value%20doesn%27t%20affect%20the%20state%20of%20the%20following%20check%20box
          Then we have to make sure that wifi is off - thats all other interfaces are off except ethernet with crossover RJ45.
        </script>
        <h2>SourceTree open from VSCode cli</h2>
        <script type="editor" data-lang="python">

          # --------- git bash ------------- vvv
          # add to .bash_profile
            alias stree="start \"\" \"C:\Users\xxxxxxxxxxx\AppData\Local\SourceTree\SourceTree.exe\" -f \"\$(pwd)\""
            alias sm="start \"\" \"C:\Program Files\Sublime Merge\sublime_merge.exe\" \"\$(pwd)\""
          # -------------------------------- ^^^

          # copy that script to /c/Users/szdz/bin/stree.cmd (using git bash terminal)
          # WARNING: you might need to change path in >set sourcetreepath=< section, just find location to sourcetree and update
          # vvvvvvvvvvvvvvvvvvvvvvvvvvvv
          @echo off
          setlocal enabledelayedexpansion

          set sourcetreepath="C:\Users\szdz\AppData\Local\SourceTree\SourceTree.exe"

          REM Convert the first argument to a full path
          set directory=%~f1
          REM If the first argument is empty use the current directory
          if "%directory%" == "" set directory=%CD%

          REM If the first argument is not a directory (e.g. a file) remove the filename
          if not exist "%directory%\*" (
              set directory=%~dp1
          )

          REM go to the target directory
          pushd "%directory%"

          REM get the root of the repository
          for /f "delims=" %%i in ('git rev-parse --show-toplevel') do set directory=%%i
          git rev-parse --show-toplevel 1> nul 2> nul

          if %errorlevel% EQU 0 (
              start "" "%sourcetreepath%" -f "%directory:/=\%"
          )

          popd
          endlocal
          # ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
          # above from: https://github.com/ArloL/dotfiles/blob/6f2699d68c681a867cdc540260210cd32928365f/bin/stree.cmd

          then execute (in git bash terminal)

          cat <<EEE > /c/Users/szdz/.bash_profile
          alias stree="/c/Users/szdz/bin/stree.cmd"
          EEE

          # from now on just open VSCode then open GIT BASH terminal (yes you can choose type of terminal in VSCode)
          # and simply run
          stree
          # but run it in directory with .git directory
        </script>
      </div>
    </div>
    <script type="module" src="/js/github.js"></script>
  </body>
</html>
